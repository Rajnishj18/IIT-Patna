<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personal Daily Planner ‚Äî Pro</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    :root{
      --bg1:#ffecd2; --bg2:#fcb69f; --ink:#2d3436; --brand:#0984e3; --brand-2:#74b9ff;
      --ok:#2ecc71; --no:#e74c3c; --chip:#eef2ff; --muted:#6b7280;
      --hi:#ef4444; --med:#f59e0b; --lo:#10b981; --card:#ffffff; --shadow:0 4px 10px rgba(0,0,0,.15);
    }
    *{box-sizing:border-box}
    body{
      font-family:'Segoe UI', system-ui, -apple-system, Roboto, sans-serif;
      background:linear-gradient(to right, var(--bg1), var(--bg2));
      margin:0; padding:0; display:flex; flex-direction:column; align-items:center;
    }
    header{
      background:var(--ink); color:#fff; width:100%; padding:18px 12px; text-align:center;
      position:sticky; top:0; z-index:5; box-shadow:var(--shadow);
    }
    header h1{margin:0; font-size:1.35rem; letter-spacing:.3px}
    header .sub{margin-top:6px; font-size:.9rem; color:#d1d5db}

    main{width:clamp(300px, 92vw, 1000px); padding:14px}

    section.card{
      margin:14px 0; background:var(--card); padding:16px; border-radius:12px; box-shadow:var(--shadow);
    }
    .row{display:flex; flex-wrap:wrap; gap:10px}
    .row > *{flex:1 1 220px}

    label{display:block; font-size:.85rem; color:var(--muted); margin:6px 2px}
    select, input[type="text"], input[type="time"], textarea{
      width:100%; padding:10px 12px; border:1px solid #e5e7eb; border-radius:10px; outline:none;
      transition:.2s; background:#fff;
    }
    select:focus, input:focus, textarea:focus{border-color:var(--brand); box-shadow:0 0 0 3px rgba(9,132,227,.15)}

    .btn{padding:10px 16px; border:none; border-radius:10px; cursor:pointer; font-weight:600; transition:.2s;}
    .btn.primary{background:var(--brand); color:white}
    .btn.primary:hover{background:var(--brand-2)}
    .btn.ghost{background:#fff; border:1px solid #e5e7eb}
    .btn.danger{background:var(--no); color:#fff}
    .btn-row{display:flex; gap:10px; flex-wrap:wrap}

    /* Table */
    .table-wrap{max-height:60vh; overflow:auto; border-radius:12px; box-shadow:var(--shadow); background:#fff}
    table{border-collapse:collapse; width:100%}
    th, td{border-bottom:1px solid #f1f5f9; padding:10px 12px; text-align:left}
    thead th{position:sticky; top:0; background:var(--brand); color:#fff; z-index:2}
    tbody tr:nth-child(odd){background:#ffffff}
    tbody tr:nth-child(even){background:#f8fafc}

    .status-chip{display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; font-weight:600; font-size:.85rem}
    .done{color:var(--ok); background:#e9f9ef;}
    .not-done{color:var(--no); background:#fde8e7}

    .priority{display:inline-block; padding:4px 10px; border-radius:999px; font-weight:700; font-size:.8rem}
    .p-high{background:#fee2e2; color:var(--hi)}
    .p-medium{background:#fef3c7; color:var(--med)}
    .p-low{background:#dcfce7; color:var(--lo)}

    .actions{display:flex; gap:8px}
    .icon-btn{cursor:pointer; border:none; background:transparent; font-size:1.1rem}

    .filters{display:flex; gap:10px; flex-wrap:wrap}

    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <h1>üìù Personal Daily Planner</h1>
    <div class="sub" id="quote">Focus on progress, not perfection.</div>
  </header>

  <main>
    <!-- Add / Edit Form -->
    <section class="card" id="formCard">
      <h3 style="margin:0 0 10px 0">Add Your Daily Task</h3>
      <div class="row">
        <div>
          <label for="day">Day</label>
          <select id="day">
            <option value="">Select Day</option>
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
            <option>Sunday</option>
          </select>
        </div>
        <div>
          <label for="startTime">Start Time</label>
          <input type="time" id="startTime" />
        </div>
        <div>
          <label for="endTime">End Time</label>
          <input type="time" id="endTime" />
        </div>
        <div style="flex:2 1 260px">
          <label for="task">Task / Activity</label>
          <input type="text" id="task" placeholder="e.g., Morning run, Math revision, Client call" />
        </div>
        <div>
          <label for="priority">Priority</label>
          <select id="priority">
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
          </select>
        </div>
      </div>
      <div class="btn-row" style="margin-top:10px">
        <button class="btn primary" id="addBtn">Add Task</button>
        <button class="btn ghost" id="resetBtn" type="button">Reset</button>
      </div>
    </section>

    <!-- Controls -->
    <section class="card">
      <div class="btn-row" style="margin-bottom:10px">
        <button class="btn primary" id="pdfBtn">Download PDF</button>
        <button class="btn ghost" onclick="window.print()">Print</button>
        <button class="btn ghost" id="csvBtn">Export CSV</button>
        <button class="btn danger" id="clearBtn">Clear All</button>
      </div>

      <div class="filters">
        <div style="flex:1 1 200px">
          <label for="filterDay">Filter by Day</label>
          <select id="filterDay">
            <option value="">All Days</option>
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
            <option>Sunday</option>
          </select>
        </div>
        <div style="flex:1 1 200px">
          <label for="filterStatus">Filter by Status</label>
          <select id="filterStatus">
            <option value="">All</option>
            <option value="done">Completed</option>
            <option value="not-done">Not Done</option>
          </select>
        </div>
        <div style="flex:2 1 260px">
          <label for="search">Search Task</label>
          <input type="text" id="search" placeholder="Type to search..." />
        </div>
      </div>
    </section>

    <!-- Table -->
    <div class="table-wrap" id="table-container">
      <table id="planner">
        <thead>
          <tr>
            <th style="width:120px">Day</th>
            <th style="width:160px">Time Range</th>
            <th>Task / Activity</th>
            <th style="width:120px">Priority</th>
            <th style="width:140px">Status</th>
            <th style="width:120px">Actions</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </main>

  <script>
    // ====== Data Store ======
    const LS_KEY = 'planner.tasks.v2';
    let tasks = [];
    let editingId = null;

    const $ = (q)=>document.querySelector(q);

    const inputs = {
      day: $('#day'), start: $('#startTime'), end: $('#endTime'), task: $('#task'), priority: $('#priority')
    };
    const filters = {
      day: $('#filterDay'), status: $('#filterStatus'), search: $('#search')
    };

    function uid(){return Math.random().toString(36).slice(2)+Date.now().toString(36)}

    function save(){localStorage.setItem(LS_KEY, JSON.stringify(tasks))}
    function load(){ try{ tasks = JSON.parse(localStorage.getItem(LS_KEY) || '[]') }catch{ tasks = [] } }

    function resetForm(){
      editingId = null;
      inputs.day.value = '';
      inputs.start.value = '';
      inputs.end.value = '';
      inputs.task.value = '';
      inputs.priority.value = 'Low';
      $('#addBtn').textContent = 'Add Task';
    }

    function validate(){
      if(!inputs.day.value || !inputs.start.value || !inputs.end.value || !inputs.task.value.trim()){
        alert('Please fill all fields!');
        return false;
      }
      return true;
    }

    function render(){
      const tbody = $('#tbody');
      tbody.innerHTML = '';

      const dayF = filters.day.value;
      const statusF = filters.status.value;
      const q = filters.search.value.toLowerCase();

      const filtered = tasks.filter(t=>{
        if(dayF && t.day!==dayF) return false;
        if(statusF && t.status!==statusF) return false;
        if(q && !(`${t.task} ${t.day} ${t.priority}`.toLowerCase().includes(q))) return false;
        return true;
      });

      for(const t of filtered){
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${t.day}</td>
          <td>${t.start} - ${t.end}</td>
          <td>${escapeHtml(t.task)}</td>
          <td>${priorityChip(t.priority)}</td>
          <td>${statusChip(t.status)}</td>
          <td class="actions">
            <button class="icon-btn" title="Mark Done" onclick="markStatus('${t.id}','done')">‚úîÔ∏è</button>
            <button class="icon-btn" title="Mark Not Done" onclick="markStatus('${t.id}','not-done')">‚ùå</button>
            <button class="icon-btn" title="Edit" onclick="editTask('${t.id}')">‚úèÔ∏è</button>
            <button class="icon-btn" title="Delete" onclick="deleteTask('${t.id}')">üóëÔ∏è</button>
          </td>`;
        tbody.appendChild(tr);
      }
    }

    function priorityChip(p){
      const cls = p==='High'?'p-high': p==='Medium'?'p-medium':'p-low';
      return `<span class="priority ${cls}">${p}</span>`;
    }
    function statusChip(s){
      const cls = s==='done'?'done':'not-done';
      return `<span class="status-chip ${cls}">${s==='done'?'‚úîÔ∏è Completed':'‚ùå Not Done'}</span>`;
    }
    function escapeHtml(str){
      return str.replace(/[&<>"']/g, (c)=>({"&":"&amp;","<":"&lt;",
        ">":"&gt;","\"":"&quot;","'":"&#39;"}[c]))
    }

    function addOrUpdate(){
      if(!validate()) return;
      const payload = {
        day: inputs.day.value,
        start: inputs.start.value,
        end: inputs.end.value,
        task: inputs.task.value.trim(),
        priority: inputs.priority.value,
      };
      if(editingId){
        const i = tasks.findIndex(t=>t.id===editingId);
        if(i>-1){ tasks[i] = {...tasks[i], ...payload}; }
      } else {
        tasks.push({id:uid(), ...payload, status:'not-done'});
      }
      save(); render(); resetForm();
    }

    function editTask(id){
      const t = tasks.find(x=>x.id===id); if(!t) return;
      editingId = id;
      inputs.day.value = t.day;
      inputs.start.value = t.start;
      inputs.end.value = t.end;
      inputs.task.value = t.task;
      inputs.priority.value = t.priority;
      $('#addBtn').textContent = 'Update Task';
      window.scrollTo({top:0, behavior:'smooth'});
    }

    function deleteTask(id){
      if(!confirm('Delete this task?')) return;
      tasks = tasks.filter(t=>t.id!==id);
      save(); render();
    }

    function markStatus(id, status){
      const t = tasks.find(x=>x.id===id); if(!t) return;
      t.status = status;
      save(); render();
    }

    function clearAll(){
      if(!confirm('Clear ALL tasks?')) return;
      tasks = []; save(); render();
    }

    function exportCSV(){
      const headers = ['Day','Start Time','End Time','Task','Priority','Status'];
      const rows = tasks.map(t=>[t.day,t.start,t.end,`"${t.task.replace(/"/g,'""')}"`,t.priority,t.status]);
      const csv = [headers.join(','), ...rows.map(r=>r.join(','))].join('\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'Daily_Planner.csv'; a.click();
      URL.revokeObjectURL(url);
    }

    function downloadPDF(){
      const element = document.getElementById('table-container');
      const opt = {
        margin:       10,
        filename:     'Daily_Planner.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2 },
        jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }

    const QUOTES = [
      'Focus on progress, not perfection.',
      'Small steps every day lead to big results.',
      'What gets scheduled gets done.',
      'Discipline beats motivation.',
      'Your future is built by what you do today.'
    ];
    function rotateQuote(){
      const q = document.getElementById('quote');
      let i = Math.floor(Math.random()*QUOTES.length);
      q.textContent = QUOTES[i];
      setInterval(()=>{ i=(i+1)%QUOTES.length; q.textContent = QUOTES[i]; }, 8000);
    }

    document.getElementById('addBtn').addEventListener('click', addOrUpdate);
    document.getElementById('resetBtn').addEventListener('click', resetForm);
    document.getElementById('clearBtn').addEventListener('click', clearAll);
    document.getElementById('csvBtn').addEventListener('click', exportCSV);
    document.getElementById('pdfBtn').addEventListener('click', downloadPDF);

    // Init
    render();
    rotateQuote();
  </script>
</body>
</html>
